{include file="/app/rmcore/view/public/hearder" /}

<body  style="overflow: auto;border-radius: 3px;">


<div class="tab-contain" style="margin-top: 10px;">
    <!-- tab栏 -->
    <ul id="tabs">
        <li class="current"><span title="tab1">常规选项</span></li>
        <li><span  title="tab2">其他选项</span></li>
        <a onclick="window.history.go(-1);" class="ax-btn ax-sm  ax-primary bi bi-arrow-left-short" style="position: absolute;right: 35px; width: 60px;height: 33px;"> 返回</a>
    </ul>

    <div style="height: 1px;background-color: gainsboro"></div>
    <!-- 对应显示内容 -->

    <div id="contents">
        <form action="{$actions.download_request_add}"  method="post" onsubmit="return Fcheck();">
            <div id="tab1" class="item show">
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label">标题：</div>
                        <div class="ax-form-input"><input type="text" name="title" id="title" placeholder="请输入标题"></div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label">排序：</div>
                        <div class="ax-form-input"><input type="text" name="sort" value="" placeholder="0"></div>
                    </div>
                </div>
                <!--<div class="ax-break-md"></div>-->
                <!--<div class="ax-form-group">-->
                    <!--<div class="ax-flex-row">-->
                        <!--<div class="ax-form-label">文档属性：</div>-->
                        <!--<div class="ax-flex-block">-->
                            <!--<label class="ax-checkbox"><input name="free-orange" value="0" type="checkbox"><span>头条</span></label>-->
                            <!--<label class="ax-checkbox"><input name="free-orange" value="1" type="checkbox"><span>推荐</span></label>-->
                            <!--<label class="ax-checkbox"><input name="free-orange" value="1" type="checkbox"><span>热门</span></label>-->
                            <!--<label class="ax-checkbox"><input name="free-orange" value="2" type="checkbox"><span>其他</span></label>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label">封面图：</div>
                        <div class="ax-form-con">
                            <div class="ax-form-input">
                                <input id="file" onchange=handleFile("file") class="ax-input-file showImg" type="file">
                                <input name="org_img" value="" placeholder="上传图片" id="org_img_file" type="text">
                                <span  class="ax-file-btn">选择图片</span>
                            </div>
                            <div class="large"></div>
                        </div>
                    </div>
                </div>
                <!--<div class="ax-break-lg"></div>-->
                <!--<div class="ax-form-group">-->
                    <!--<div class="ax-flex-row">-->
                        <!--<div class="ax-form-label">下载限制：</div>-->
                        <!--<div class="ax-form-con">-->
                            <!--<div class="ax-form-input">-->
                                <!--<select name="model">-->
                                    <!--<option value="0">不限会员</option>-->
                                    <!--<option value="2">注册会员</option>-->
                                    <!--<option value="3">初级会员</option>-->
                                    <!--<option value="4">中级会员</option>-->
                                    <!--<option value="5">高级会员</option>-->
                                <!--</select>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label">上传文件：</div>
                        <div class="ax-form-con">
                            <div class="ax-form-input">
                                <input name="file_url" placeholder="点击上传文件" id="file-view3"  type="text">
                                <span class="ax-file-btn" id="file-add">添加</span>
<!--                                <input onmouseout="document.getElementById('file-upload2').style.display='none';" id="file-view2" type="text">-->
<!--                                <span onmouseover="document.getElementById('file-upload2').style.display='block';" class="ax-file-btn">选择</span>-->
<!--                                <input onchange="document.getElementById('file-view2').value=this.value;" id="file-upload2" class="ax-input-file" type="file">-->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label">内容详情：</div>
                        <div style="position: relative;width:700px ">
                            <div id="content" class=""></div>
                        </div>
                    </div>
                </div>

                <div class="ax-break-lg"></div>
                <div class="ax-break-lg"></div>

                <input name="pid" value="" type="hidden">
                <input name="col_id" value="{$column_id}" type="hidden">
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label"></div>
                        <div class="ax-flex-block">
                            <div class="ax-form-input"><button type="submit" class="ax-btn ax-primary ax-full">确认提交</button></div>
                        </div>
                    </div>
                </div>

            </div>

            <div id="tab2" class="item">
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <span class="ax-form-label">TGA标签：</span>
                        <div class="ax-form-input"><input type="text" name="tags" placeholder="请输入TGA标签"></div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>

                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <span class="ax-form-label">SEO标题：</span>
                        <div class="ax-form-input"><input type="text" name="seo_title" placeholder="请输入SEO标题"></div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>

                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <span class="ax-form-label">SEO关键词：</span>
                        <div class="ax-form-input"><input type="text" name="seo_key" placeholder="请输入SEO关键词"></div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>

                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <span class="ax-form-label">SEO描述：</span>
                        <div class="ax-form-input">
                            <textarea name="seo_des" cols="" rows="" placeholder="请简单描述一下"></textarea>
                        </div>
                    </div>
                </div>
                <!--<div class="ax-break-lg"></div>-->
                <!--<div class="ax-form-group">-->
                    <!--<div class="ax-flex-row">-->
                        <!--<span class="ax-form-label">作者：</span>-->
                        <!--<div class="ax-form-input"><input type="text"></div>-->
                    <!--</div>-->
                <!--</div>-->
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <span class="ax-form-label">浏览量：</span>
                        <div class="ax-form-input"><input type="text" placeholder="0"></div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <span class="ax-form-label">下载量：</span>
                        <div class="ax-form-input"><input type="text" name="hits" placeholder="0"></div>
                    </div>
                </div>
                <!--<div class="ax-break-lg"></div>-->
                <!--<div class="ax-form-group">-->
                    <!--<div class="ax-flex-row">-->
                        <!--<div class="ax-form-label">阅读权限：</div>-->
                        <!--<div class="ax-form-con">-->
                            <!--<div class="ax-form-input">-->
                                <!--<select name="model">-->
                                    <!--<option value="0">开放阅读</option>-->
                                    <!--<option value="1">待审核稿件</option>-->
                                <!--</select>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label">发布时间：</div>
                        <div class="ax-form-con">
                            <div class="ax-form-input"><input name="" placeholder="选择时间" type="text" id="datepicker02"></div>
                        </div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>
                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label">文档模板：</div>
                        <div class="ax-form-con">
                            <div class="ax-form-input">
                                <select name="">
                                    <option value="0">模板1</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ax-break-lg"></div>
                <div class="ax-break-lg"></div>

                <div class="ax-form-group">
                    <div class="ax-flex-row">
                        <div class="ax-form-label"></div>
                        <div class="ax-flex-block">
                            <div class="ax-form-input"><button type="button" class="ax-btn ax-primary ax-full">确认提交</button></div>
                        </div>
                    </div>
                </div>


            </div>
        </form>
    </div>
</div>

</body>
<link href="/static/rmtop/css/jtstyle.css" rel="stylesheet" type="text/css" >
<script src="/static/rmtop/js/dropzone.js" type="text/javascript"></script>
<script type="text/javascript">

    if ($.cookie('download_edit_tab_current')!= null){
        let num = $.cookie("download_edit_tab_current");
        $('#tabs li').removeClass("current").removeClass("hoverItem");
        $("#tabs li ").find("span").eq(num).parent().addClass("current");
        $("#contents div").removeClass("show");
        if(num == 1){
            $("#tab2").addClass('show')
        }else{
            $("#tab1").addClass('show')
        }
    }else{
        let num = 0;
        $('#tabs li').removeClass("current").removeClass("hoverItem");
        $("#tabs li ").find("span").eq(num).parent().addClass("current");
        $("#contents div").removeClass("show");
        $("#tab1").addClass('show')
    }

    $('#tabs li span').click(function(e) {
        e.preventDefault();
        $('#tabs li').removeClass("current").removeClass("hoverItem");
        $(this).parent().addClass("current");
        $("#contents div").removeClass("show");
        $('#' + $(this).attr('title')).addClass('show');
        let index = $("#tabs li ").find("span").index(this);
        $.cookie('download_edit_tab_current',index);
    });


    //发布时间
    //    $('#datepicker02').mobiscroll().date({
    //        theme: 'ax',
    //        lang:'zh',
    //        onBeforeShow:function(event, inst){//显示前的点击事件
    //            $('#'+this.id).addClass('ax-focus')
    //        },
    //        onClose: function (event, inst) {//关闭事件
    //            $('#'+this.id).removeClass('ax-focus');
    //        },
    //        display: 'bubble',
    //        rows:5,
    //    });

    $(document).ready(function () {
        $("#file-add").dropzone({
            url: "{$actions.upload}",
            // previewTemplate: $('#template01').html(),
            paramName: "file",
            maxFilesize: 5,
            maxFiles: 5,
            addRemoveLinks:true,
            acceptedFiles: ".jpg,.png,.gif,.txt,.doc,.docx,.xsl,.xslx,.pdf,.mp4,.ogg,.mpeg4,.webm",
            init: function () {

                var myDropzone = this, submitButton = document.querySelector("#qr"),
                    cancelButton = document.querySelector("#cancel");
                myDropzone.on("complete", function(file) {
                    myDropzone.removeFile(file);
                });

                myDropzone.on('addedfile', function (file) {
                    //添加上传文件的过程，可再次弹出弹框，添加上传文件的信息
                });
                myDropzone.on('sending', function (data, xhr, formData) {
                    //向后台发送该文件的参数

                });

                myDropzone.on('success', function (files, response) {
                    //文件上传成功之后的操作
                    $("#file-view3").val(response.savename)

                });
                myDropzone.on('error', function (files, response) {
                    //文件上传失败后的操作
                });
            }
        });

        $("#file-add2").dropzone({
            url: "{$actions.upload}",
            // previewTemplate: $('#template01').html(),
            paramName: "file",
            maxFilesize: 5,
            maxFiles: 5,
            addRemoveLinks:true,
            acceptedFiles: ".jpg,.png,.gif,.txt,.doc,.docx,.xsl,.xslx,.pdf,.mp4,.ogg,.mpeg4,.webm",
            init: function () {

                var myDropzone = this, submitButton = document.querySelector("#qr"),
                    cancelButton = document.querySelector("#cancel");
                myDropzone.on("complete", function(file) {
                    myDropzone.removeFile(file);
                });

                myDropzone.on('addedfile', function (file) {
                    //添加上传文件的过程，可再次弹出弹框，添加上传文件的信息
                });
                myDropzone.on('sending', function (data, xhr, formData) {
                    //向后台发送该文件的参数

                });

                myDropzone.on('success', function (files, response) {
                    //文件上传成功之后的操作
                    $("#file-view4").val(response.savename)

                });
                myDropzone.on('error', function (files, response) {
                    //文件上传失败后的操作
                });
            }
        });
    });

</script>

<script charset="utf-8" src="/static/neditor/neditor.config.js"></script>
<script charset="utf-8" src="/static/neditor/neditor.all.js"></script>
<script charset="utf-8" src="/static/neditor/neditor.service.js"></script>
<script>
    UE.getEditor("content",{
        autoHeight: false,
        initialFrameHeight:400,
        initialFrameWidth:window.screen.width/2.2,
    });
</script>

<script>
    //鼠标移动到上传图片输入框预览图片
    $(function(){
        var ei = $(".large");
        ei.hide();
        $(".showImg").mousemove(function(e){
            var UpsImg = $('#org_img_file').val()
            ei.html('<img src=" '+ UpsImg +' " />').show();
        }).mouseout( function(){
            ei.hide();
        })
    });
</script>

<script type="text/javascript">
    function Fcheck() {
        if($('#title').val() == '') {
            layer.tips('请输入标题', '#title', {tips: [2, '#4ea1f5'], tipsMore: false, time:1500});
            $('#title').focus();
            return false;
        }
        if($('#org_img_file').val() == '') {
            layer.tips('请上传封面图', '#org_img_file', {tips: [2, '#4ea1f5'], tipsMore: false, time:1500});
            $('#org_img_file').focus();
            return false;
        }
        if($('#file-view3').val() == '') {
            layer.tips('请上传文件', '#file-view3', {tips: [2, '#4ea1f5'], tipsMore: false, time:1500});
            $('#file-view3').focus();
            return false;
        }
        return true;
    }
</script>
